---
title: "Donnermeyer_Homework_8"
author: "Sam Donnermeyer"
date: "11/19/2020"
output: html_document
---

```{r setup, include=FALSE}
# Packages Required
packages <- c("tidyverse", "ggplot2", "doBy") 

# Installs missing packages
if ( length(missing_pkgs <- setdiff(packages, rownames(installed.packages())) > 0)) { 
  message("installing missing package(s): ", paste(missing_pkgs, collapse = ", ")) 
  install.packages(missing_pkgs)
}

# Attaches packages to project 
require(ggplot2)
require(tidyverse)
require(doBy)
```

## STAT 451: Hand In Homework #8

### Sam Donnermeyer

```{r read data, include = FALSE}
# Read in data files 
data_df = read_csv("MM-All.csv")
data_df = mutate(data_df, NetWt=GrossWeight-1.3)
```


***
#### **(a)** Create side-by-side boxplots of the net weights with proper labels and describe what you find, focusing on the comparison of the two samples.

```{r boxplots}
# Create boxplots of the net weights - separated by year
boxplot = ggplot(data_df, aes(Year, NetWt)) +
  geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=FALSE) +
  # Add x label 
  xlab("Continent") +
  # Add y label
  ylab("M&M Package Net Weight (grams)") +
  # Add title to the chart
  ggtitle("M&M Package Net Weight by Year") +
  # Themes
  scale_colour_viridis_d() + 
  # Theme
  theme(
    # hide panel borders and remove grid lines
    panel.background = element_rect(fill = "white"),
    panel.border = element_blank(), 
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    # change axis titles 
    axis.line = element_line(color = "black"),
    axis.title = element_text(size=9),
    # Change the title orientation 
    plot.title = element_text(hjust = 0.5)
  )

boxplot
```

The preceding box-plots reveal interesting aspects of the distribution of M&M's net weight of packages between the years 2016 & 2017. 
 - Both 2016 & 2017 have very similar medians (~ 51 grams), however, their spread is very different. 2017 M&M packages have much less variability, while 2016 has a much larger IQR and overall spread. 


***
#### **(b)** Do the assumptions of t procedures appear satisfied? 

Assumptions: 
 - Randomization Condition: The data are from a simple random sample from the population.
    - The sample is assumed to be a simple random sample from shipments of M&M's the store received in the respective years. 
 - 10% Condition: The sample is no more than 10% of the population. 
    - Yes, 48 bags is no more than 10% of the population. 
 - Normality: The data come from a normal population. 
    - Since n for each year is 15 $\le$ n $\le$ 40, it is assumed that the population distribution is unimodal and roughly symmetric. 


***
#### **(c)** Report the group means, standard deviations and sample sizes in a table.

```{r summary_table}
# Create Summaries of the groups 
summary <- function(x){
  c(mean=mean(x), sd=sd(x), length=length(x))
}

summaryBy(NetWt~Year, data = data_df, FUN = summary)
```


***
#### **(d)** Report the 99% confidence interval for the difference in means.

```{r confidence_interval}
## Create a 99% confidence interval for the difference in means ## 
# separate data by year
data_2016 = data_df[which(data_df$Year == "Y2016"),]
data_2017 = data_df[which(data_df$Year == "Y2017"),]

# Confidence Interval for the difference of two means
t_test = t.test(data_2016$NetWt, data_2017$NetWt, data = data_df, conf.level = .99)
t_test
```

We are 99% confident that the mean effect of the 2016 sample from the 2017 sample of net weight of M&M packages is in the interval (`r round(t_test$conf.int[1], 3)`, `r round(t_test$conf.int[2], 3)`). 


***
#### **(e)** Report the P-value for a two-sided test of the hypothesis that the two population means are equal
The p-value for the two-sided test of the hypothesis that the population means between the net weight of M&M packages in 2016 and 2017 is p-value = `r round(t_test$p.value, 3)`. With a p-value of `r round(t_test$p.value, 3)`, there is no evidence in favor of the alternative hypothesis - that the mean net weight of M&M packages in 2016 and 2017 are different. 
