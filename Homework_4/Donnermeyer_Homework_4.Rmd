---
title: "Donnermeyer_Homework_4"
author: "Sam Donnermeyer"
date: "10/2/2020"
output: html_document
---

```{r packages, include=FALSE}
# Packages Required
packages <- c("tidyverse", "ggplot2", "Stat2Data") 

# Installs missing packages
if ( length(missing_pkgs <- setdiff(packages, rownames(installed.packages())) > 0)) { 
  message("installing missing package(s): ", paste(missing_pkgs, collapse = ", ")) 
  install.packages(missing_pkgs)
}

# Attaches packages to project 
require(ggplot2)
require(tidyverse)
require(Stat2Data)
```

## Hand In Homework #4

```{r read data, include = TRUE}
# Read in data files 
kite_df = read_csv("Kites.csv")
data(ButterfliesBc)
```

### Problem #1: Hookbilled Kites

***
#### **(a)** Create an appropriate scatterplot of tail length vs. wing length.

```{r scatterplot}
# Create Scatterplot
ggplot(kite_df, aes(x=Wing, y=Tail)) + 
  geom_point() +
  ggtitle("Kite Tail length vs. Wing length") +
  xlab("Wing Length (mm)") + 
  ylab("Tail Length (mm)") +
  # Themes
  scale_colour_viridis_d() + 
  # Theme
  theme(
    # hide panel borders and remove grid lines
    panel.background = element_rect(fill = "white"),
    panel.border = element_blank(), 
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    # change axis titles 
    axis.line = element_line(color = "black"),
    axis.title = element_text(size=11),
    # Change the title orientation 
    plot.title = element_text(hjust = 0.5)
  )
```

There is an obvious outlier at Wing Length ~280mm and Tail Length ~280mm. This outlier is not a high leverage point because it is not an extreme value in respect to the Wing Length. However, this point is influential because it would change the least squares line substantially. 

***
#### **(b)** Create an appropriate scatterplot of wing length vs. tail length.

```{r scatterplot2}
# Create Scatterplot
ggplot(kite_df, aes(x=Tail, y=Wing)) + 
  geom_point() +
  ggtitle("Kite Wing length vs. Tail length") +
  ylab("Wing Length (mm)") + 
  xlab("Tail Length (mm)") +
  # Themes
  scale_colour_viridis_d() + 
  # Theme
  theme(
    # hide panel borders and remove grid lines
    panel.background = element_rect(fill = "white"),
    panel.border = element_blank(), 
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    # change axis titles 
    axis.line = element_line(color = "black"),
    axis.title = element_text(size=11),
    # Change the title orientation 
    plot.title = element_text(hjust = 0.5)
  )
```

The same outlier found in the last plot is evident in the plot generated by comparing wing length vs. tail length. The outlier is still a high influence point, meaning it will shift the least squares regregsion line, but it is also a high leverage point, an observation with an extreme tail length. 


### Problem #2: Butterlies 

***
#### **(a)** Create an appropriate scatterplot of wing length vs. temperature.

```{r scatterplot_Butterflies}
# Create Scatterplot
ggplot(ButterfliesBc, aes(x=Wing, y=Temp)) + 
  geom_point() +
  ggtitle("Butterfly Wing length vs. Temperature") +
  xlab("Average Temperature of Preceding Summer (C)") + 
  ylab("Wing Length (mm)") +
  # Themes
  scale_colour_viridis_d() + 
  # Theme
  theme(
    # hide panel borders and remove grid lines
    panel.background = element_rect(fill = "white"),
    panel.border = element_blank(), 
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    # change axis titles 
    axis.line = element_line(color = "black"),
    axis.title = element_text(size=11),
    # Change the title orientation 
    plot.title = element_text(hjust = 0.5)
  )
```

There appears to be no relationship between wing length in butterflies and the average temperature for the preceding summer in Greenland for the Boloria Chariclea Butterfly.

```{r include=FALSE}
# Fit a regression model for predicting wing length from just temperature
m <- lm(Wing ~ Temp, data=ButterfliesBc)
sm <- summary(m)
```


Linear Regression Model: 
The linear regression model that predicts the butterfly's wing length from the average temperature of the preceding summer is as follows: 

$$ \widehat {Wing Length} = `r format(round(coef(m)[1], 3), nsmall = 3)` + `r round(coef(m)[2],3)`\,(Temperature) $$

Which means, for every additional degree (C) average increase in the temperature of the preceding summer in Greenland, the butterfly's wing length decreases by .235mm. 

The $R^2$ value: `r format(round((cor(ButterfliesBc$Temp,ButterfliesBc$Wing) ** 2), 3), nsmall = 3)`. This means that `r format((round((cor(ButterfliesBc$Temp,ButterfliesBc$Wing) ** 2), 3)*100), nsmall = 1)`% of variation in the Wing length in the Boloria Chariclea is explained by the average temperature of the preceding summer. 

The $s_e$ value is `r format(round(sm$sigma, 3), nsmall = 3)` which indicates that the predictions from this model are expected to be off by about `r format(round(sm$sigma, 3), nsmall = 3)` millimeters on average of Butterflies from the same population.

***
#### **(b)** Create an appropriate scatterplot of wing length vs. temperature with sex as an added dimension.

```{r scatterplot_Butterflies2}
# Create Scatterplot
ggplot(ButterfliesBc, aes(x=Wing, y=Temp, color=Sex)) + 
  geom_point() +
  geom_smooth(method = lm, se=FALSE) +
  ggtitle("Butterfly Wing length vs. Temperature") +
  xlab("Average Temperature of Preceding Summer (C)") + 
  ylab("Wing Length (mm)") +
  # Themes
  scale_colour_viridis_d() + 
  # Theme
  theme(
    # hide panel borders and remove grid lines
    panel.background = element_rect(fill = "white"),
    panel.border = element_blank(), 
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    # change axis titles 
    axis.line = element_line(color = "black"),
    axis.title = element_text(size=11),
    # Change the title orientation 
    plot.title = element_text(hjust = 0.5)
  )
```

```{r}
# Same slope, different intercepts for Male and Females
m1 <- lm(Wing~Sex+Temp, data=ButterfliesBc)
s1 <- summary(m1)
s1
```

On average, male Butterflies have wing lengths about .93 mm shorter than females that experienced the same average temperature during the preceding summer. Additionally, for both male and female Butterflies, the predicted wing length decreases by .24 mm for every additional average degree of C during the preceding summer. 

The $R^2$ value: `r format(round((s1$r.squared), 3), nsmall = 3)`. This means that `r format((round(s1$r.squared, 3)*100), nsmall = 1)`% of variation in the Wing length in the Boloria Chariclea is explained by the average temperature of the preceding summer. Not accounting for the sex of the butterfly, the $R^2$ value was `r format(round((cor(ButterfliesBc$Temp,ButterfliesBc$Wing) ** 2), 3), nsmall = 3)`, which means that the model that accounts for sex accounts for more variation in the observed data. 

The $s_e$ value is `r format(round(s1$sigma, 3), nsmall = 3)` which indicates that the predictions from this model are expected to be off by about `r format(round(s1$sigma, 3), nsmall = 3)` millimeters on average of Butterflies from the same population. Not accounting for the sex of the butterfly, the $s_e$ value was `r format(round(sm$sigma, 3), nsmall = 3)`, which means that the model that accounts for sex is more accurate, because the $s_e$ value is smaller. 

***
#### **(c)** Create an appropriate scatterplot of wing length vs. temperature with sex as an added dimension and each sex has its own slope.

```{r}
# Different Intercepts and different slopes for Male and Females
m2 <- lm(Wing~Sex+Temp+Sex:Temp, data=ButterfliesBc)
s2 <- summary(m2)
s2
```

The $R^2$ value: `r format(round((s2$r.squared), 3), nsmall = 3)`
The $s_e$ value is `r format(round(s2$sigma, 3), nsmall = 3)`

With both male and female butterflies having thier own slope returns negligable differences from that of the model that seperated male and female's intercepts but the slope remained shared.

***
#### **(d)** Make a residual plot and a histogram of residuals (side-by-side)for the model in part (b). Do the regression assumptions appear satisfied?
```{r Residuals, fig.show='hold', out.width='50%'}
ggplot(ButterfliesBc,aes(x=Temp,y=resid(m1))) + 
  geom_point() + 
  geom_hline(yintercept=0) + 
  ggtitle("Residual Plot") +
  xlab("Average Temperature of Preceding Summer (C)") +
  ylab("Wing Length (mm)") +
  # Themes
  scale_colour_viridis_d() + 
  # Theme
  theme(
    # hide panel borders and remove grid lines
    panel.background = element_rect(fill = "white"),
    panel.border = element_blank(), 
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    # change axis titles 
    axis.line = element_line(color = "black"),
    axis.title = element_text(size=9),
    # Change the title orientation 
    plot.title = element_text(hjust = 0.5)
  )

ggplot(NULL,aes(x=resid(m1))) + 
  geom_histogram(binwidth=.2) +
  ggtitle("Histogram of Residuals") +
  xlab("Residuals") + 
  ylab("Count") + 
  # Themes
  scale_colour_viridis_d() + 
  # Theme
  theme(
    # hide panel borders and remove grid lines
    panel.background = element_rect(fill = "white"),
    panel.border = element_blank(), 
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    # change axis titles 
    axis.line = element_line(color = "black"),
    axis.title = element_text(size=11),
    # Change the title orientation 
    plot.title = element_text(hjust = 0.5)
  )
```

The equal variance and distribution of the residuals appear to be satisfied. The residual plot reveals that the residuals have about equal variance over all values of the predictors. And the histogram of the residuals reveals that the residuals are unimodal and symmetric. 